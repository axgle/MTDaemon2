base on http://www.phpclasses.org/browse/file/27399.html
